<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sahasam Treasure Game</title>
  <style> 
/* Replace the existing CSS with this updated version */

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', sans-serif;
  height: 100vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
  touch-action: manipulation; /* Improves touch responsiveness */
}

.background-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('./poster.jpg') no-repeat center center;
  background-size: cover;
  filter: brightness(0.2);
  z-index: -1;
}

/* Landing Page Styles */
.landing-page {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  max-width: 800px;
  height: 100%;
  text-align: center;
  padding: 20px;
}

.movie-poster {
  width: min(70vw, 300px);
  height: auto;
  margin-bottom: 5vh;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}

.landing-title {
  color: #e5b014;
  font-size: clamp(2rem, 8vw, 2.5rem);
  font-weight: bold;
  margin-bottom: 2vh;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
}

.landing-subtitle {
  color: #ffffff;
  font-size: clamp(1rem, 4vw, 1.2rem);
  margin-bottom: 6vh;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
  padding: 0 10px;
}

.start-game-btn {
  padding: 15px 30px;
  font-size: clamp(1.1rem, 5vw, 1.3rem);
  font-weight: bold;
  background: linear-gradient(45deg, #e5b014, #f0c419);
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 5px 15px rgba(229, 176, 20, 0.4);
  text-transform: uppercase;
  min-width: 200px;
}

.start-game-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(229, 176, 20, 0.6);
}

/* Game Container Styles */
.game-container {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  max-width: 100vw;
  height: 100vh;
  padding: 20px;
}

.sahasam-logo {
  width: min(70vw, 300px);
  height: auto;
  margin-bottom: 3vh;
}

h1 {
  margin-bottom: 3vh;
  color: #e5b014;
  font-size: clamp(1.3rem, 6vw, 1.6rem);
  text-align: center;
}

#timer {
  font-size: clamp(1.1rem, 5vw, 1.3rem);
  color: #e3342f;
  font-weight: bold;
  margin-bottom: 3vh;
  text-align: center;
}

#game-board {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: min(4vw, 15px);
  justify-content: center;
  margin-bottom: 4vh;
  width: min(95vw, 450px);
  max-width: 450px;
}

.card {
  width: 100%;
  aspect-ratio: 1;
  min-width: 70px;
  max-width: 100px;
  perspective: 1000px;
  cursor: pointer;
}

.inner {
  width: 100%;
  height: 100%;
  position: relative;
  transition: transform 0.6s;
  transform-style: preserve-3d;
}

.card.flipped .inner {
  transform: rotateY(180deg);
}

.front, .back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border: 2px solid #f0f0f0;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(1.5rem, 7vw, 2rem);
  font-weight: bold;
}

.front {
  background: #f59e0b;
  color: transparent;
}

.back {
  background: #1a1a1a;
  color: white;
  transform: rotateY(180deg);
}

#message {
  font-size: clamp(1.1rem, 5vw, 1.3rem);
  text-align: center;
  font-weight: bold;
  min-height: 25px;
  color: #ffffff;
  margin-top: 2vh;
}

/* Progress Display */
.progress-container {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 3vh;
  gap: 10px;
  flex-wrap: wrap;
}

.progress-text {
  color: #e5b014;
  font-size: clamp(1rem, 4.5vw, 1.2rem);
  font-weight: bold;
  margin-right: 10px;
}

.letter-progress {
  display: flex;
  gap: min(3vw, 8px);
}

.letter-slot {
  width: min(10vw, 40px);
  height: min(10vw, 40px);
  min-width: 30px;
  min-height: 30px;
  border: 2px solid #e5b014;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(1rem, 4.5vw, 1.2rem);
  font-weight: bold;
  color: #666;
  background: rgba(229, 176, 20, 0.1);
  transition: all 0.5s ease;
}

/* Popup Modal Styles */
.popup-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 20px;
}

.popup-content {
  background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
  padding: clamp(20px, 6vh, 40px);
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
  border: 2px solid #e5b014;
  width: min(95vw, 400px);
}

.popup-icon {
  font-size: clamp(3rem, 15vw, 4rem);
  margin-bottom: 20px;
}

.popup-title {
  font-size: clamp(1.5rem, 7vw, 2rem);
  font-weight: bold;
  margin-bottom: 15px;
  color: #e5b014;
}

.popup-message {
  font-size: clamp(1rem, 4.5vw, 1.2rem);
  margin-bottom: 30px;
  color: #ffffff;
  line-height: 1.5;
}

.popup-buttons {
  display: flex;
  gap: 15px;
  justify-content: center;
  flex-wrap: wrap;
}

.popup-btn {
  padding: 12px 20px;
  font-size: clamp(1rem, 4.5vw, 1.2rem);
  font-weight: bold;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  min-width: 140px;
}

/* Mobile-specific optimizations */
@media (max-width: 480px) {
  .landing-page {
    padding: 15px;
  }
  
  .movie-poster {
    margin-bottom: 4vh;
  }
  
  .landing-subtitle {
    margin-bottom: 5vh;
  }
  
  .start-game-btn {
    min-width: 180px;
    padding: 14px 25px;
  }
  
  #game-board {
    gap: 3vw;
    width: 95vw;
  }
  
  .card {
    min-width: 20vw;
    max-width: 22vw;
  }
  
  .popup-buttons {
    flex-direction: column;
    gap: 10px;
  }
  
  .popup-btn {
    width: 100%;
  }
  
  .letter-slot {
    width: 12vw;
    height: 12vw;
    min-width: 35px;
    min-height: 35px;
  }
}

/* Very small screens (e.g., iPhone 5/SE) */
@media (max-width: 320px) {
  .card {
    min-width: 22vw;
    max-width: 24vw;
  }
  
  .letter-slot {
    width: 14vw;
    height: 14vw;
  }
  
  .start-game-btn {
    min-width: 160px;
    padding: 12px 20px;
  }
}

/* Landscape orientation adjustments */
@media (orientation: landscape) and (max-height: 600px) {
  .landing-page {
    padding: 10px;
  }
  
  .movie-poster {
    width: min(40vh, 200px);
    margin-bottom: 2vh;
  }
  
  .landing-title {
    font-size: clamp(1.5rem, 5vh, 2rem);
    margin-bottom: 1vh;
  }
  
  .landing-subtitle {
    font-size: clamp(0.9rem, 3vh, 1.1rem);
    margin-bottom: 3vh;
  }
  
  .sahasam-logo {
    width: min(30vh, 180px);
    margin-bottom: 1vh;
  }
  
  h1 {
    font-size: clamp(1.1rem, 4vh, 1.3rem);
    margin-bottom: 1vh;
  }
  
  #timer {
    font-size: clamp(1rem, 3.5vh, 1.1rem);
    margin-bottom: 1vh;
  }
  
  .progress-container {
    margin-bottom: 1vh;
  }
  
  #game-board {
    margin-bottom: 2vh;
    width: min(70vh, 400px);
    gap: 2vw;
  }
  
  .card {
    min-width: 15vh;
    max-width: 16vh;
  }
  
  .popup-content {
    padding: 15px;
  }
}
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

</head>
<body>
  <div class="background-overlay"></div>
  
  <!-- Landing Page -->
  <div class="landing-page" id="landing-page">
    <img src="./sahasam.png" class="movie-poster" alt="Sahasam Movie Poster">
    <h1 class="landing-title">LETTER GAME</h1>
    <p class="landing-subtitle">Are you ready ?</p>
    <button class="start-game-btn" onclick="startGameFromLanding()">Start </button>
  </div>
  
  <!-- Game Container -->
  <div class="game-container" id="game-container">
    <img src="./sahasam.png" class="sahasam-logo" alt="Sahasam Logo">
    <h1>Find "SAHASAM"</h1>
    <div id="timer">Time left: <span id="time">30</span>s</div>
    
    <!-- Progress Display -->
    <div class="progress-container">
      <div class="progress-text">Progress:</div>
      <div class="letter-progress" id="letter-progress"></div>
    </div>
    
    <div id="game-board"></div>
    <div id="message"></div>
  </div>

  <!-- Popup Modal -->
  <div class="popup-overlay" id="popup-overlay">
    <div class="popup-content" id="popup-content">
      <div class="popup-icon" id="popup-icon"></div>
      <div class="popup-title" id="popup-title"></div>
      <div class="popup-message" id="popup-message"></div>
      <div class="popup-buttons">
        <button class="popup-btn play-again-btn" onclick="playAgain()">Play Again</button>
        <button class="popup-btn back-home-btn" onclick="backToHome()">Back to Home</button>
      </div>
    </div>
  </div>

  <script>
    const TARGET = "SAHASAM";
    let currentIndex = 0;
    let timeLeft = 24;
    let timer;
    let clickable = true;

    // Audio context for sound effects
    let audioContext;
    let clickSound, correctSound, wrongSound, winSound, loseSound;

    // Initialize audio
    function initAudio() {
      try {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // Create different sounds
        clickSound = createBeepSound(800, 0.1, 0.3);
        correctSound = createBeepSound(1200, 0.3, 0.5); // Higher pitch for correct
        wrongSound = createBeepSound(300, 0.4, 0.4); // Lower pitch for wrong
        winSound = createMelody([600, 800, 1000, 1200], 0.15, 0.6); // Victory melody
        loseSound = createBeepSound(200, 0.8, 0.5);
      } catch (e) {
        console.log('Audio not supported');
      }
    }

    function createBeepSound(frequency, duration, volume) {
      return () => {
        if (!audioContext) return;
        
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = frequency;
        oscillator.type = 'sine';
        
        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
        gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.01);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration);
      };
    }

    function createMelody(frequencies, noteDuration, volume) {
      return () => {
        if (!audioContext) return;
        
        frequencies.forEach((freq, index) => {
          setTimeout(() => {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = freq;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + noteDuration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + noteDuration);
          }, index * noteDuration * 1000);
        });
      };
    }

    function playSound(sound) {
      if (sound && audioContext && audioContext.state === 'running') {
        sound();
      }
    }

    // Create particle effect
    function createParticles(element) {
      const rect = element.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      for (let i = 0; i < 8; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = centerX + 'px';
        particle.style.top = centerY + 'px';
        particle.style.transform = `translate(-50%, -50%) rotate(${i * 45}deg) translateY(-20px)`;
        
        document.body.appendChild(particle);
        
        setTimeout(() => {
          particle.remove();
        }, 1000);
      }
    }

    // Initialize progress display
    function initProgressDisplay() {
      const progressContainer = document.getElementById('letter-progress');
      progressContainer.innerHTML = '';
      
      TARGET.split('').forEach((letter, index) => {
        const slot = document.createElement('div');
        slot.className = 'letter-slot';
        slot.textContent = letter;
        slot.id = `slot-${index}`;
        progressContainer.appendChild(slot);
      });
    }

    // Update progress display
    function updateProgress(index) {
      const slot = document.getElementById(`slot-${index}`);
      if (slot) {
        slot.classList.add('found', 'bounce-in');
        createParticles(slot);
      }
    }

    function startGameFromLanding() {
      initAudio();
      document.getElementById('landing-page').style.display = 'none';
      document.getElementById('game-container').style.display = 'flex';
      setTimeout(() => {
        startGame();
      }, 500);
    }

    function startGame() {
      const board = document.getElementById("game-board");
      const message = document.getElementById("message");
      const timeDisplay = document.getElementById("time");

      currentIndex = 0;
      clickable = true;
      timeLeft = 24;
      clearInterval(timer);
      timeDisplay.textContent = timeLeft;
      message.textContent = "";
      board.innerHTML = "";

      // Initialize progress display
      initProgressDisplay();

      // Generate letters
      const targetLetters = TARGET.split("");
      const distractors = "BCDEFGIJKLMNOPQRTUVWXYZ".split("");
      let allLetters = [...targetLetters];

      while (allLetters.length < 12) {
        let rand = distractors[Math.floor(Math.random() * distractors.length)];
        allLetters.push(rand);
      }

      // Shuffle
      allLetters = allLetters.sort(() => Math.random() - 0.5);

      allLetters.forEach(letter => {
        const card = document.createElement("div");
        card.classList.add("card");

        const inner = document.createElement("div");
        inner.classList.add("inner");

        const front = document.createElement("div");
        front.classList.add("front");

        const back = document.createElement("div");
        back.classList.add("back");
        back.textContent = letter;

        inner.appendChild(front);
        inner.appendChild(back);
        card.appendChild(inner);

        card.dataset.letter = letter;

        card.addEventListener("click", () => {
          if (!clickable || card.classList.contains("flipped")) return;

          // Play click sound
          playSound(clickSound);
          
          card.classList.add("flipped");

          if (letter === TARGET[currentIndex]) {
            // Correct letter found
            setTimeout(() => {
              playSound(correctSound);
              card.classList.add("correct", "found", "glow-effect");
              updateProgress(currentIndex);
              currentIndex++;
              
              if (currentIndex === TARGET.length) {
                // Add celebration animation to the game board
                document.getElementById('game-board').classList.add('celebration');
                setTimeout(() => {
                  endGame(true);
                }, 800);
              }
            }, 300);
          } else {
            // Wrong letter
            setTimeout(() => {
              playSound(wrongSound);
              card.classList.add("wrong");
              clickable = false;
              
              setTimeout(() => {
                card.classList.remove("flipped", "wrong");
                clickable = true;
              }, 1000);
            }, 300);
          }
        });

        board.appendChild(card);
      });

      timer = setInterval(() => {
        timeLeft--;
        timeDisplay.textContent = timeLeft;
        
        // Add warning color when time is running low
        const timerElement = document.getElementById('timer');
        if (timeLeft <= 5) {
          timerElement.style.color = '#ef4444';
          timerElement.classList.add('glow-effect');
        } else if (timeLeft <= 10) {
          timerElement.style.color = '#f59e0b';
        }
        
        if (timeLeft <= 0) {
          endGame(false);
        }
      }, 1000);
    }

    function endGame(win) {
      clearInterval(timer);
      clickable = false;
      
      // Play win or lose sound
      setTimeout(() => {
        if (win) {
          playSound(winSound);
        } else {
          playSound(loseSound);
        }
      }, 500);
      
      // Show popup after a brief delay
      setTimeout(() => {
        showPopup(win);
      }, 1000);
    }

    function showPopup(win) {
      const overlay = document.getElementById('popup-overlay');
      const content = document.getElementById('popup-content');
      const icon = document.getElementById('popup-icon');
      const title = document.getElementById('popup-title');
      const message = document.getElementById('popup-message');

      if (win) {
        content.className = 'popup-content win';
        icon.innerHTML = '<i class="fas fa-trophy"></i>'; 

        title.textContent = 'VAULT UNLOCKED!';
        message.textContent = 'Congratulations! You have successfully found all the letters and unlocked the treasure vault!';
      } else {
        content.className = 'popup-content lose';
        icon.innerHTML = '<i class="fas fa-hourglass-end"></i>';
        title.textContent = 'TIME\'S UP!';
        message.textContent = 'The treasure remains locked! Your time has run out, but don\'t give up - try again!';
      }

      overlay.style.display = 'flex';
    }

    function playAgain() {
      document.getElementById('popup-overlay').style.display = 'none';
      
      // Reset timer styling
      const timerElement = document.getElementById('timer');
      timerElement.style.color = '#e3342f';
      timerElement.classList.remove('glow-effect');
      
      // Reset game board animation
      document.getElementById('game-board').classList.remove('celebration');
      
      setTimeout(() => {
        startGame();
      }, 300);
    }

    function backToHome() {
      document.getElementById('popup-overlay').style.display = 'none';
      document.getElementById('game-container').style.display = 'none';
      document.getElementById('landing-page').style.display = 'flex';
    }

    // Initialize audio context on first user interaction
    document.addEventListener('click', function initAudioOnFirstClick() {
      if (!audioContext) {
        initAudio();
      }
      document.removeEventListener('click', initAudioOnFirstClick);
    }, { once: true });

    // Start with landing page
    window.onload = function() {
      document.getElementById('landing-page').style.display = 'flex';
    };
  </script>
</body>
</html>
